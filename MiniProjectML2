{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/aishautwa/miniproject?scriptVersionId=251602482\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"code","execution_count":1,"id":"f90658ef","metadata":{"execution":{"iopub.execute_input":"2025-07-21T05:45:10.35934Z","iopub.status.busy":"2025-07-21T05:45:10.359009Z","iopub.status.idle":"2025-07-21T05:45:16.500113Z","shell.execute_reply":"2025-07-21T05:45:16.499502Z"},"papermill":{"duration":6.146292,"end_time":"2025-07-21T05:45:16.501495","exception":false,"start_time":"2025-07-21T05:45:10.355203","status":"completed"},"tags":[]},"outputs":[],"source":["import numpy as np\n","import matplotlib.pyplot as plt\n","import soundfile as sf \n","import librosa \n","import librosa.display \n","import os \n","from sklearn.model_selection import train_test_split \n","from sklearn.svm import SVC \n","from sklearn.metrics import accuracy_score, classification_report \n","import torch "]},{"cell_type":"code","execution_count":2,"id":"7cbc4172","metadata":{"execution":{"iopub.execute_input":"2025-07-21T05:45:16.507118Z","iopub.status.busy":"2025-07-21T05:45:16.506823Z","iopub.status.idle":"2025-07-21T05:45:16.56888Z","shell.execute_reply":"2025-07-21T05:45:16.568167Z"},"papermill":{"duration":0.065864,"end_time":"2025-07-21T05:45:16.570052","exception":false,"start_time":"2025-07-21T05:45:16.504188","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Menggunakan device: cuda\n"]}],"source":["\n","device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n","print(f\"Menggunakan device: {device}\")"]},{"cell_type":"markdown","id":"9ea0d981","metadata":{"papermill":{"duration":0.002014,"end_time":"2025-07-21T05:45:16.574352","exception":false,"start_time":"2025-07-21T05:45:16.572338","status":"completed"},"tags":[]},"source":["## Ekstraksi MMFC dan load dataset"]},{"cell_type":"code","execution_count":3,"id":"d7d83577","metadata":{"execution":{"iopub.execute_input":"2025-07-21T05:45:16.579641Z","iopub.status.busy":"2025-07-21T05:45:16.579122Z","iopub.status.idle":"2025-07-21T05:45:16.583945Z","shell.execute_reply":"2025-07-21T05:45:16.583026Z"},"papermill":{"duration":0.00869,"end_time":"2025-07-21T05:45:16.585172","exception":false,"start_time":"2025-07-21T05:45:16.576482","status":"completed"},"tags":[]},"outputs":[],"source":["def extract_mfcc_features(file_path, n_mfcc=13):\n","\n","    y_audio, sr_audio = librosa.load(file_path, sr=None) \n","    \n","    if y_audio.ndim > 1:\n","        y_audio = y_audio[:, 0]\n","\n","    mfccs = librosa.feature.mfcc(y=y_audio, sr=sr_audio, n_mfcc=n_mfcc)\n","    \n","    mfccs_mean = np.mean(mfccs, axis=1)\n","    \n","    return mfccs_mean, sr_audio\n","    \n","base_audio_path = '/kaggle/input/emotionaudiodataset/Voice Emotion Dataset'\n","\n","emotion_labels = ['angry', 'happy', 'neutral'] \n","\n","all_features = [] \n","all_labels = [] "]},{"cell_type":"code","execution_count":4,"id":"c29ad77d","metadata":{"execution":{"iopub.execute_input":"2025-07-21T05:45:16.590335Z","iopub.status.busy":"2025-07-21T05:45:16.590123Z","iopub.status.idle":"2025-07-21T05:45:40.33378Z","shell.execute_reply":"2025-07-21T05:45:40.332807Z"},"papermill":{"duration":23.747937,"end_time":"2025-07-21T05:45:40.335193","exception":false,"start_time":"2025-07-21T05:45:16.587256","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Memulai pengumpulan fitur MFCC untuk emosi yang dipilih...\n","Memproses emosi: angry...\n","Memproses emosi: happy...\n","Memproses emosi: neutral...\n","\n","Pengumpulan fitur selesai. Total sampel data: 600\n"]}],"source":["print(\"Memulai pengumpulan fitur MFCC untuk emosi yang dipilih...\")\n","for emotion in emotion_labels:\n","    emotion_folder_path = os.path.join(base_audio_path, emotion)\n","    \n","    if not os.path.exists(emotion_folder_path):\n","        print(f\"Peringatan: Folder '{emotion_folder_path}' tidak ditemukan. Melewati emosi '{emotion}'.\")\n","        continue\n","\n","    print(f\"Memproses emosi: {emotion}...\")\n","    for filename in os.listdir(emotion_folder_path):\n","        if filename.endswith('.wav') or filename.endswith('.mp3'):\n","            file_path = os.path.join(emotion_folder_path, filename)\n","            try:\n","                mfccs_mean, _ = extract_mfcc_features(file_path, n_mfcc=13)\n","                all_features.append(mfccs_mean)\n","                all_labels.append(emotion)\n","            except Exception as e:\n","                print(f\"Error memproses {file_path}: {e}\")\n","                continue\n","\n","X = np.array(all_features)\n","y = np.array(all_labels)\n","\n","print(f\"\\nPengumpulan fitur selesai. Total sampel data: {len(X)}\")\n","if len(X) == 0:\n","    print(\"Tidak ada data yang terkumpul. Pastikan path dataset dan struktur folder benar.\")\n","    exit()"]},{"cell_type":"markdown","id":"826356c3","metadata":{"papermill":{"duration":0.002221,"end_time":"2025-07-21T05:45:40.340157","exception":false,"start_time":"2025-07-21T05:45:40.337936","status":"completed"},"tags":[]},"source":["## Membagi data untuk training dan testing"]},{"cell_type":"code","execution_count":5,"id":"58686784","metadata":{"execution":{"iopub.execute_input":"2025-07-21T05:45:40.346318Z","iopub.status.busy":"2025-07-21T05:45:40.345543Z","iopub.status.idle":"2025-07-21T05:45:40.355415Z","shell.execute_reply":"2025-07-21T05:45:40.354568Z"},"papermill":{"duration":0.014051,"end_time":"2025-07-21T05:45:40.35658","exception":false,"start_time":"2025-07-21T05:45:40.342529","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["\n","Ukuran X_train (fitur latih): (480, 13)\n","Ukuran y_train (label latih): (480,)\n","Ukuran X_test (fitur uji): (120, 13)\n","Ukuran y_test (label uji): (120,)\n"]}],"source":["X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42, stratify=y)\n","\n","print(f\"\\nUkuran X_train (fitur latih): {X_train.shape}\")\n","print(f\"Ukuran y_train (label latih): {y_train.shape}\")\n","print(f\"Ukuran X_test (fitur uji): {X_test.shape}\")\n","print(f\"Ukuran y_test (label uji): {y_test.shape}\")"]},{"cell_type":"markdown","id":"2c1d69b4","metadata":{"papermill":{"duration":0.002107,"end_time":"2025-07-21T05:45:40.36097","exception":false,"start_time":"2025-07-21T05:45:40.358863","status":"completed"},"tags":[]},"source":["## Membangun dan melatih model SVM"]},{"cell_type":"code","execution_count":6,"id":"c47950bc","metadata":{"execution":{"iopub.execute_input":"2025-07-21T05:45:40.366511Z","iopub.status.busy":"2025-07-21T05:45:40.366042Z","iopub.status.idle":"2025-07-21T05:45:40.381014Z","shell.execute_reply":"2025-07-21T05:45:40.380174Z"},"papermill":{"duration":0.018964,"end_time":"2025-07-21T05:45:40.382181","exception":false,"start_time":"2025-07-21T05:45:40.363217","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["\n","Melatih model SVM...\n","Model SVM berhasil dilatih.\n"]}],"source":["svm_model = SVC(kernel='rbf', C=1.0, gamma='scale', random_state=42)\n","\n","print(\"\\nMelatih model SVM...\")\n","svm_model.fit(X_train, y_train)\n","print(\"Model SVM berhasil dilatih.\")"]},{"cell_type":"markdown","id":"94cc5efa","metadata":{"papermill":{"duration":0.002198,"end_time":"2025-07-21T05:45:40.386751","exception":false,"start_time":"2025-07-21T05:45:40.384553","status":"completed"},"tags":[]},"source":["## Prediksi dan Evaluasi Model"]},{"cell_type":"code","execution_count":7,"id":"03d400eb","metadata":{"execution":{"iopub.execute_input":"2025-07-21T05:45:40.392057Z","iopub.status.busy":"2025-07-21T05:45:40.391648Z","iopub.status.idle":"2025-07-21T05:45:40.413636Z","shell.execute_reply":"2025-07-21T05:45:40.412974Z"},"papermill":{"duration":0.025726,"end_time":"2025-07-21T05:45:40.414715","exception":false,"start_time":"2025-07-21T05:45:40.388989","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["\n","--- Hasil Pengujian Model SVM pada Data Uji ---\n","Akurasi Model: 0.8500\n","Akurasi Model (Data Latih): 0.8458\n","\n","Laporan Klasifikasi (Precision, Recall, F1-score):\n","              precision    recall  f1-score   support\n","\n","       angry       0.89      0.82      0.86        40\n","       happy       0.72      0.90      0.80        40\n","     neutral       1.00      0.82      0.90        40\n","\n","    accuracy                           0.85       120\n","   macro avg       0.87      0.85      0.85       120\n","weighted avg       0.87      0.85      0.85       120\n","\n"]}],"source":["y_pred = svm_model.predict(X_test)\n","\n","print(\"\\n--- Hasil Pengujian Model SVM pada Data Uji ---\")\n","\n","accuracy = accuracy_score(y_test, y_pred)\n","print(f\"Akurasi Model: {accuracy:.4f}\")\n","\n","y_train_pred = svm_model.predict(X_train)\n","accuracy_train = accuracy_score(y_train, y_train_pred)\n","print(f\"Akurasi Model (Data Latih): {accuracy_train:.4f}\")\n","\n","print(\"\\nLaporan Klasifikasi (Precision, Recall, F1-score):\")\n","print(classification_report(y_test, y_pred, target_names=emotion_labels))"]},{"cell_type":"markdown","id":"ddda1e19","metadata":{"papermill":{"duration":0.002203,"end_time":"2025-07-21T05:45:40.419296","exception":false,"start_time":"2025-07-21T05:45:40.417093","status":"completed"},"tags":[]},"source":["visualisasi"]},{"cell_type":"code","execution_count":8,"id":"e5a45e9a","metadata":{"execution":{"iopub.execute_input":"2025-07-21T05:45:40.425456Z","iopub.status.busy":"2025-07-21T05:45:40.425252Z","iopub.status.idle":"2025-07-21T05:45:40.45549Z","shell.execute_reply":"2025-07-21T05:45:40.454797Z"},"papermill":{"duration":0.034916,"end_time":"2025-07-21T05:45:40.456526","exception":false,"start_time":"2025-07-21T05:45:40.42161","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["\n","--- Menguji Sistem dengan Audio Baru: /kaggle/input/datatestingvoice/dataset_voice/angry1.wav ---\n","Sistem memprediksi emosi untuk audio baru ini adalah: ANGRY!\n"]}],"source":["new_audio_file_path = '/kaggle/input/datatestingvoice/dataset_voice/angry1.wav' \n","\n","print(f\"\\n--- Menguji Sistem dengan Audio Baru: {new_audio_file_path} ---\")\n","\n","try:\n","\n","    mfccs_new_audio_mean, _ = extract_mfcc_features(new_audio_file_path, n_mfcc=13)\n","\n","    if mfccs_new_audio_mean.shape[0] != X_train.shape[1]:\n","        print(f\"Error: Dimensi fitur audio baru ({mfccs_new_audio_mean.shape[0]}) tidak cocok dengan dimensi fitur model yang dilatih ({X_train.shape[1]}).\")\n","    else:\n","        predicted_emotion = svm_model.predict(mfccs_new_audio_mean.reshape(1, -1))\n","        \n","        print(f\"Sistem memprediksi emosi untuk audio baru ini adalah: {predicted_emotion[0].upper()}!\")\n","\n","except FileNotFoundError:\n","    print(f\"Error: File audio baru tidak ditemukan di '{new_audio_file_path}'. Mohon periksa path untuk pengujian.\")\n","except Exception as e:\n","    print(f\"Terjadi error saat menguji audio baru: {e}\")"]}],"metadata":{"kaggle":{"accelerator":"gpu","dataSources":[{"datasetId":7909970,"sourceId":12530489,"sourceType":"datasetVersion"},{"datasetId":7909989,"sourceId":12530530,"sourceType":"datasetVersion"}],"dockerImageVersionId":31089,"isGpuEnabled":true,"isInternetEnabled":true,"language":"python","sourceType":"notebook"},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.11.13"},"papermill":{"default_parameters":{},"duration":36.000416,"end_time":"2025-07-21T05:45:41.980368","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2025-07-21T05:45:05.979952","version":"2.6.0"}},"nbformat":4,"nbformat_minor":5}